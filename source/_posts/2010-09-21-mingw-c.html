---
layout: post
title: "使用 MinGW 編譯 C++ 紀錄"
date: 2010-09-21T18:29:00+08:00
categories:
 - MySQL
 - MinGW
 - C++
---

<div class='post'>
1. windres Lession5.rc Lession5.o<br />2. g++ -o Lession5.exe Lession5.c Lession5.o<br />3. g++ -o sample01 sample01.cpp -mwindows (-mwindows 是在windows下執行exe檔案時,不會在跳出一個Console的視窗)<br /><br />// g++ dos(使用 Notepad++ NppExec 套件的紀錄)<br />C:\MinGW\bin\g++.exe "$(FULL_CURRENT_PATH)" -o $(NAME_PART)<br /><br />// g++(使用 Notepad++ NppExec 套件的紀錄)<br />C:\MinGW\bin\g++.exe "$(FULL_CURRENT_PATH)" -o $(NAME_PART) -mwindows -Wall( -Wall 會顯示程式中是否有無效的參數或函式)<br /><br />// g++ & rc & comctl32(使用 Notepad++ NppExec 套件的紀錄, 使用Window控制項)<br />C:\MinGW\bin\windres.exe $(NAME_PART).rc -o $(NAME_PART).o<br />C:\MinGW\bin\g++.exe "$(FULL_CURRENT_PATH)" -o $(NAME_PART) $(NAME_PART).o "C:\Program Files\Microsoft SDKs\Windows\v7.0A\Lib\comctl32.lib" -mwindows -Wall<br /><br />// g++ & rc(使用 Notepad++ NppExec 套件的紀錄)<br />C:\MinGW\bin\windres.exe $(NAME_PART).rc -o $(NAME_PART).o<br />C:\MinGW\bin\g++.exe "$(FULL_CURRENT_PATH)" -o $(NAME_PART) $(NAME_PART).o -mwindows -Wall<br /><br />// g++ & lib(使用 Notepad++ NppExec 套件的紀錄, 使用Windows Timer套件)<br />C:\MinGW\bin\g++.exe "$(FULL_CURRENT_PATH)" -o $(NAME_PART) "C:\Program Files\Microsoft SDKs\Windows\v7.0A\Lib\WinMM.Lib" -mwindows<br /><br />// C++ 連結 MySQL 的方法(不使用 Visual C++ 和 .net 的方式)<br />01. 需要上網抓取 mysql-connector-c-noinstall-6.0.2-win32<br />02. 參考 http://www.programmer-club.com/showSameTitleN/mysql/911.html<br />03. 參考 http://www.openwebspider.org/documentation/how-to-link-libmysqllib-with-dev-c-or-gcc-under-windows/<br />04. 產生 libmysql.a 的方式<br />    &gt; reimp.exe &lt;FULL_PATH_OF(MySQL\lib\opt)&gt;libmysql.lib<br />    (^ This command creates: libmysql.def AND libmysql.a)<br />    &gt; dlltool.exe –input-def LIBMYSQL.def –dllname libmysql.dll –output-lib libmysql.dll<br />    (^ this creates libmysql.dll)<br />05. 將產生的 libmysql.a 拷貝到 MinGW 的 lib 下<br />06. 在程式中, 需要 include 兩個檔案<br />    #include &lt;winsock.h&gt; // SOCKET TYPE(for mysql.h)<br />    #include &lt;mysql.h&gt;<br />07. 可以使用以下程式測試連結是否成功??<br />using namespace std;<br />int main(void) {<br />    MYSQL my_connection;    //This is a SQL connection.<br />    mysql_init(&my_connection);  //initinal mysql connection<br />  <br />    if (mysql_real_connect(&my_connection, HOST, USERNAME, PASSWORD, DATABASE, 0, NULL, CLIENT_FOUND_ROWS)) {   //connect success <br />        cout &lt;&lt; "Connection Success!!\r\n";<br />        mysql_close(&my_connection); //close database connection<br />    } else {<br />        cout &lt;&lt; "Connection Fail!!\r\n";<br />    }<br />    getch();<br />    return EXIT_SUCCESS;<br />}<br /><br />08. 編譯檔案的時候, 需要在後面加上 -lmysql -lws2_32, 如下:(使用 Notepad++ NppExec 套件的紀錄)<br />    C:\MinGW\bin\g++.exe "$(FULL_CURRENT_PATH)" -o $(NAME_PART) -I "C:\mysql_c\include" -lmysql -lws2_32<br />例如: C:\MinGW\bin\g++.exe "C:\portable\C++\WinApp\mysqlconn.cpp" -o mysqlconn -I "C:\mysql_c\include" -lmysql -lws2_32 -mwindows</div>
